"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2183],{463:(x,_,l)=>{l.d(_,{i:()=>a});class a{}},2183:(x,_,l)=>{l.r(_),l.d(_,{UploadVideoModule:()=>R});var a=l(2078),h=l(6895),u=l(433),Z=l(581),v=l(5638),f=l(655),U=l(463),C=l(7579),O=l(2722),e=l(8256),M=l(529),y=l(1481),P=l(2684);function S(n,c){if(1&n&&(e.TgZ(0,"ion-select-option",21),e._uU(1),e.qZA()),2&n){const t=c.$implicit;e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.classNamme)}}function D(n,c){if(1&n&&(e.TgZ(0,"ion-select-option",21),e._uU(1),e.qZA()),2&n){const t=c.$implicit;e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.lec_title)}}function A(n,c){1&n&&e._UZ(0,"ion-spinner",22)}function k(n,c){if(1&n&&(e.TgZ(0,"div",23),e._UZ(1,"ion-icon",24),e.TgZ(2,"span",25),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("name",t.currentStatusIcon),e.xp6(2),e.Oqu(t.uploadStatus.message)}}const q=[{path:"",component:(()=>{class n{constructor(t,o,i,s,d,p,I){var m;this.http=t,this.sanitizer=o,this.router=i,this.service=s,this.ActivatedRoute=d,this.fb=p,this.loadingCtrl=I,this.lecturesData=[],this.classData=[],this.params={},this.currentContent="",this.uploading=!1,this.uploadStatus={status:!1,message:"",statusType:""},this.statusIcons=[{name:"checkmark-circle-outline",status:"success"},{name:"close-circle-outline",status:"failed"},{name:"information-circle-outline",status:"info"}],this.currentStatusIcon="",this._unsubscribeAll=new C.x,this.uploadVideogroup=this.fb.group({classId:["",u.kI.required],lec_id:["",u.kI.required],content_icon:["",u.kI.required],content_link_duplicate:[""],content_link:[""],content_title:["",u.kI.required],content:["",u.kI.required],published_at:["",u.kI.required],file:["",u.kI.required]}),null===(m=this.uploadVideogroup.get("published_at"))||void 0===m||m.patchValue(this.service.getCurrentDate()),d.queryParams.subscribe(g=>{var V,r,T;this.params=g,null===(V=this.uploadVideogroup.get("content"))||void 0===V||V.patchValue(g.content),null===(r=this.uploadVideogroup.get("classId"))||void 0===r||r.patchValue(g.classId),this.fetchlectureDetails(g.classId),null===(T=this.uploadVideogroup.get("lec_id"))||void 0===T||T.patchValue(g.lec_id)})}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){this.fetchClassDetails(),this.ActivatedRoute.queryParams.subscribe(t=>{"true"===t.reload&&this.fetchClassDetails()})})}fetchClassDetails(){return(0,f.mG)(this,void 0,void 0,function*(){const t=new U.i;t.RequestUrl="classDetails",t.RequestObject="",yield this.service.fetchData(t).pipe((0,O.R)(this._unsubscribeAll)).subscribe(o=>{if(null!=o){if(200!==o.status)return;this.classData=o.response||[]}},o=>{},()=>{})})}readUrl(t){var o,i;if(t.target.files[0]&&t.target.files[0].size>73400320)return alert("File size exceeds the maximum allowed size (10MB). Please choose a smaller file."),void(null===(o=this.uploadVideogroup.get("file"))||void 0===o||o.setValue(""));null===(i=this.uploadVideogroup.get("file"))||void 0===i||i.patchValue(t.target.files[0])}getImgContent(t){return this.sanitizer.bypassSecurityTrustResourceUrl(t)}getSubjectsByclassId(t){return(0,f.mG)(this,void 0,void 0,function*(){const o=t?t.target.value:null;o&&this.fetchlectureDetails(o)})}fetchlectureDetails(t){return(0,f.mG)(this,void 0,void 0,function*(){const o=new U.i;o.RequestUrl="lectureDetails/"+t,o.RequestObject="",yield this.service.fetchData(o).pipe((0,O.R)(this._unsubscribeAll)).subscribe(i=>{if(null!=i){if(200!==i.status)return;this.lecturesData=i.response||[]}},i=>{},()=>{})})}switchContent(t){var o;this.currentContent=t,null===(o=this.uploadVideogroup.get("content"))||void 0===o||o.patchValue(t)}onchange_lecture(t){var o;null===(o=this.uploadVideogroup.get("content_icon"))||void 0===o||o.patchValue(this.getContent_icon())}getContent_icon(){return this.lecturesData.find(t=>{var o;return t._id==(null===(o=this.uploadVideogroup.get("lec_id"))||void 0===o?void 0:o.value)}).lec_icon}backToContent(){this.router.navigate([this.params.from],{queryParams:{classId:this.params.classId,lec_id:this.params.lec_id,contentId:this.params.contentId,from:"/tabs/lectures",reload:"true"}})}uploadContent(){var t,o,i,s,d,p,I,m;return(0,f.mG)(this,void 0,void 0,function*(){if(!this.uploadVideogroup.valid)return this.openSnackbar({status:!0,message:"Fill all the details!",statusType:"failed"}),"";this.uploading=!0,this.uploadStatus.status=!1;const g=yield this.loadingCtrl.create({message:"Uploading file...",duration:0});g.present();const V=new U.i,r=new FormData,T=(null===(t=this.uploadVideogroup.get("classId"))||void 0===t?void 0:t.value)||"",z=(null===(o=this.uploadVideogroup.get("lec_id"))||void 0===o?void 0:o.value)||"",Q=(null===(i=this.uploadVideogroup.get("content_icon"))||void 0===i?void 0:i.value)||"",F=(null===(s=this.uploadVideogroup.get("content_link"))||void 0===s?void 0:s.value)||"",N=(null===(d=this.uploadVideogroup.get("content_title"))||void 0===d?void 0:d.value)||"",B=(null===(p=this.uploadVideogroup.get("content"))||void 0===p?void 0:p.value)||"",E=(null===(I=this.uploadVideogroup.get("published_at"))||void 0===I?void 0:I.value)||"",j=(null===(m=this.uploadVideogroup.get("file"))||void 0===m?void 0:m.value)||"";r.append("classId",T),r.append("lec_id",z),r.append("content_icon",Q),r.append("content_link",F),r.append("content_title",N),r.append("content",B),r.append("published_at",E),r.append("file",j),V.RequestUrl="upload";try{const b=yield this.service.UploadFile(V,r).toPromise();if(null!=b){if(g.dismiss(),b.error)return this.openSnackbar({status:!0,message:b.response,statusType:"failed"}),"";this.uploading=!1,this.openSnackbar({status:!0,message:b.response||"File uploaded successfully!",statusType:"info"}),this.clearformcontrols()}}catch(b){console.error(b)}return""})}clearformcontrols(){var t,o,i,s,d,p;null===(t=this.uploadVideogroup.get("classId"))||void 0===t||t.setValue(""),null===(o=this.uploadVideogroup.get("lec_id"))||void 0===o||o.setValue(""),null===(i=this.uploadVideogroup.get("content_icon"))||void 0===i||i.setValue(""),null===(s=this.uploadVideogroup.get("content_title"))||void 0===s||s.setValue(""),null===(d=this.uploadVideogroup.get("published_at"))||void 0===d||d.patchValue(this.service.getCurrentDate()),null===(p=this.uploadVideogroup.get("file"))||void 0===p||p.setValue("")}getSnackbarStatus(t){this.uploadStatus.status=t}openSnackbar(t){this.uploadStatus=t,this.currentStatusIcon=this.statusIcons.filter(o=>o.status==this.uploadStatus.statusType)[0].name,this.uploadStatus.status=!0,setTimeout(()=>{this.uploadStatus.status=!1},2e3)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M.eN),e.Y36(y.H7),e.Y36(v.F0),e.Y36(P.Q),e.Y36(v.gz),e.Y36(u.qu),e.Y36(a.HT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-upload-video"]],decls:38,vars:15,consts:[[3,"translucent"],["slot","start"],["name","chevron-back-outline",3,"click"],["id","white-background",1,"ion-padding",3,"fullscreen"],[3,"formGroup"],["fill",""],["position","floating"],["formControlName","content_title","placeholder","Enter text"],["formControlName","classId","placeholder","Select Class",3,"multiple","ionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","lec_id","placeholder","Select Lecture",3,"multiple","ionChange"],[1,"drag-file-area"],["for","choose-file"],[1,"material-icons-outlined","upload-icon"],["src","assets\\upload.png","alt","","width","30px"],[1,"dynamic-message","browse-files-text"],["type","file","id","choose-file","formControlName","file",1,"default-file-input",3,"accept","change"],["expand","block",2,"margin-top","20px",3,"click"],["slot","start","name","cloud-upload-outline"],["name","lines-sharp-small",4,"ngIf"],["class","card",4,"ngIf"],[3,"value"],["name","lines-sharp-small"],[1,"card"],["size","large",3,"name"],[1,"message"]],template:function(t,o){if(1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.ALo(4,"titlecase"),e.qZA(),e.TgZ(5,"ion-buttons",1)(6,"ion-icon",2),e.NdJ("click",function(){return o.backToContent()}),e.qZA()()()(),e.TgZ(7,"ion-content",3)(8,"ion-card-content",4)(9,"ion-item",5)(10,"ion-label",6),e._uU(11,"Content title"),e.qZA(),e._UZ(12,"ion-input",7),e.qZA(),e.TgZ(13,"ion-list")(14,"ion-item",5)(15,"ion-label",6),e._uU(16,"Class"),e.qZA(),e.TgZ(17,"ion-select",8),e.NdJ("ionChange",function(s){return o.getSubjectsByclassId(s)}),e.YNc(18,S,2,2,"ion-select-option",9),e.qZA()()(),e.TgZ(19,"ion-list")(20,"ion-item",5)(21,"ion-label",6),e._uU(22,"Lecture"),e.qZA(),e.TgZ(23,"ion-select",10),e.NdJ("ionChange",function(s){return o.onchange_lecture(s)}),e.YNc(24,D,2,2,"ion-select-option",9),e.qZA()()(),e.TgZ(25,"div",11)(26,"label",12)(27,"span",13),e._UZ(28,"img",14),e.qZA(),e.TgZ(29,"h3",15),e._uU(30," Choose file here "),e.qZA(),e.TgZ(31,"input",16),e.NdJ("change",function(s){return o.readUrl(s)}),e.qZA(),e._uU(32),e.qZA()(),e.TgZ(33,"ion-button",17),e.NdJ("click",function(){return o.uploadContent()}),e._UZ(34,"ion-icon",18),e._uU(35),e.YNc(36,A,1,0,"ion-spinner",19),e.qZA()(),e.YNc(37,k,4,2,"div",20),e.qZA()),2&t){let i,s,d;e.Q6J("translucent",!0),e.xp6(3),e.hij(" Upload ",e.lcZ(4,13,null==(i=o.uploadVideogroup.get("content"))?null:i.value)," "),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("formGroup",o.uploadVideogroup),e.xp6(9),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",o.classData),e.xp6(5),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",o.lecturesData),e.xp6(7),e.Q6J("accept","video"==(null==(s=o.uploadVideogroup.get("content"))?null:s.value)?"video/mp4":"audio"==(null==(s=o.uploadVideogroup.get("content"))?null:s.value)?"audio/mp3":"document"==(null==(s=o.uploadVideogroup.get("content"))?null:s.value)?"application/pdf":""),e.xp6(1),e.hij(" ",null==(d=o.uploadVideogroup.get("file"))?null:d.value.name," "),e.xp6(3),e.hij(" ",o.uploading?"Uploading ":"Upload"," "),e.xp6(1),e.Q6J("ngIf",o.uploading),e.xp6(1),e.Q6J("ngIf",o.uploadStatus.status)}},dependencies:[h.sg,h.O5,a.YG,a.Sm,a.FN,a.W2,a.Gu,a.gu,a.pK,a.Ie,a.Q$,a.q_,a.t9,a.n0,a.PQ,a.wd,a.sr,a.QI,a.j9,u.Fj,u.JJ,u.JL,u.sg,u.u,h.rS],styles:[".card[_ngcontent-%COMP%]{position:fixed;width:85%;bottom:0;z-index:1000;animation:_ngcontent-%COMP%_snackbar .3s cubic-bezier(.215,.61,.355,1);background:transparent;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:al .3s ease-in}@keyframes _ngcontent-%COMP%_snackbar{0%{left:-200px}50%{left:10px}to{left:18px}}.drag-file-area[_ngcontent-%COMP%]{border:2px dashed #7b2cbf;border-radius:40px;margin:10px 0 15px;padding:30px 50px;width:100%;text-align:center}.drag-file-area[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:50px}.drag-file-area[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:26px;margin:15px 0}.drag-file-area[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:19px}.drag-file-area[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .browse-files-text[_ngcontent-%COMP%]{color:#7b2cbf;font-weight:bolder;cursor:pointer}.browse-files[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;top:-25px}.default-file-input[_ngcontent-%COMP%]{opacity:0}"]}),n})()}];let J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[v.Bz.forChild(q),v.Bz]}),n})(),R=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,a.Pc,u.u5,J,Z.e,u.UX]}),n})()},2722:(x,_,l)=>{l.d(_,{R:()=>v});var a=l(4482),h=l(5403),u=l(8421),Z=l(5032);function v(f){return(0,a.e)((U,C)=>{(0,u.Xf)(f).subscribe((0,h.x)(C,()=>C.complete(),Z.Z)),!C.closed&&U.subscribe(C)})}}}]);